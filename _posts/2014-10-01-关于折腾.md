---
layout: post
title: 关于折腾
---

> 关于折腾，一句话：不做死，就不会死。

## 缘起
----

凡事皆有原因，由因生果。

## 正文
----

### 前天

公司的设计人员嫌自己的机器卡，时常出现系统僵死的情况，主要是内存不足的原因，解决方案很简单，加个内存条就可以了。由于之前有过买了内存条装上后，主板不支持的现象，所以，在买内存条之前，先查查机器主板是否支持。实现查了一下百度Dell XPS 8500主板相关的信息，很混乱，有说支持8G的，有说支持16G的，不一而是。最后，Jason打电话给Dell官方，得知，主板最高可支持32G。

在买内存条时，我鼓动Jason买金士顿的内存条，不为别的，就因为听说其兼容性好，虽然我自己从来没买过金士顿的内存条。然后，Jason就买了个8G的骇客神条。上午定的货，下午就送到了，京东的送货速度还真是超级快。

晚上，设计人员走后，将其机器拆开，把8G的内存条装上去，然后开机，看系统信息。咋一看，这是个很简单的行为，实际存在一个很不方面的因素，设计人员用的是Wacom画板，是个相难用的东西，至少对我而言，相当的不习惯鼠标在桌面上飘逸的感觉。好不容易打开了系统信息，一看，傻眼了。安装物理内存16G，可用8G。想想可能是，内存不兼容，或者其他的什么原因，从别人闲置中拆了根4G的内存条试试，识别12G，可用8G。

世界充满了限制，以及现象很不符合理论。比如，64位系统安装16G，怎么可能8G可用，这不科学。为了寻找自己的科学，不断的、反复的尝试，无非就是拆了插，插了重启，反复了几次，尝试了各种方法，最后，放弃了。懊悔浪费这么长时间尝试这么无聊的事情。Jason说，明天退货。

在别人都走了后，我看着这根明天将要退货的神条，萌生了想要将它插到自己的机器上的想法。这个想法，有如滴在渲纸上的水墨，迅速扩展了。犹豫了一下，关机拆箱插条。打开机箱发现，小机箱中，结构相当的紧凑，内存条插槽位置相当的隐蔽。

<div class="site-avatar">
  <img src="assets/images/machine.jpg">
</div> 

费了九牛二虎之力，终于将内存条插了进去，开机之后，傻眼了，一直定格在Ubuntu logo的上，长达十几分钟。起初觉得可能是，内存条不兼容的问题。将内存换回去后，情况依旧。我在想，会不会，插槽进灰了。清理了一下灰，花去几十分钟。插了后试试了试，居然正常了。很高兴了把后盖啊，螺丝啊之类都拧上去，又试了试，又TMD挂了，欺骗我的感情啊，不带这样的。

<div class="site-avatar">
  <img src="assets/images/ubuntu_logo.jpg">
</div> 

不知不觉，到了10点半，要回去睡觉了，不能再拖了，明天继续搞，大不了重装系统，临走之前最后一试，无意中，按了Ctrl+Alt+F1，结果进入了tty的界面，一阵窃喜，看来系统是确实启动了的 。使用free命令查看了一下内存，显示为8G，得知内存也没有问题的，只是进不去图形界面。

只等明天来，重装系统了。

### 昨天

早上过来后，想重装系统，发现没有U盘。突然，想到新买的闲置的Dell机器，插电自动安装Ubuntu。从市场部的办公室把机器抱过来，装系统，升级系统，备份原本数据。总而言之，就是各种复制粘贴等待。其中，将安装完成的操作系统又12.04升级到14.04时，等了相当长的时间，2006个文件的下载，解压，安装。直到中午吃饭时，才完成了。

期间，没有电脑用，就是各种不干事。被Jason说，如果不拆机装内存条，不久什么事都没有了。确实是的，如果当时没有手贱，啥事都没有了。。。

复制数据的时候，特别感谢Ubuntu的文件管理器Nautilus支持以图形的方式，以sftp协议从其他服务器上拉数据，非常的方便。

恢复完系统，发现自己对新的机器和系统有一些不太满意的地方。 

1. CPU居然是Intel双核的, 原先用的机器是i3的
2. 网络链接不稳定，经常掉线，掉线就要取插拔网线，看了网上的介绍说因为系统内核和老式的Intel CPU架构不兼容的问题
3. vim中不支持主选择区复制

虽然很不满意，但是，装系统恢复数据让我非常疲惫，无论是精神上，还是肉体上，都想被蹂躏了一般。关机看书去了，看了一会儿书，发现书也看不进去了。刚好，国庆提前放假，早早的回去休息了。

### 今天

今天是国庆节的第一天，早上8点多就醒了，9点半左右到公司学习看书。之所以不再宿舍看书，主要觉得凳子和桌子的高度不满意。

看了一天书后，下午，5点多的时候，打看电脑，打开终端，打开VIM，那个`vim中不支持主选择区复制`的问题，我又回到了起点上，看看能不能将原先的机器上的系统恢复过来，仔细想想不就是不能进入图形界面吗，找到问题解决了不久行了。

Lightdm的日志的错误:

    ** (lightdm-gtk-greeter:1585): WARNING **: Failed to load background: Failed to open file '/usr/share/backgrounds/warty-final-ubuntu.png': No such file or directory

    (lightdm-gtk-greeter:1585): Gtk-CRITICAL **: gtk_container_foreach: assertion 'GTK_IS_CONTAINER (container)' failed

    (lightdm-gtk-greeter:1585): Gtk-CRITICAL **: gtk_container_foreach: assertion 'GTK_IS_CONTAINER (container)' failed

    (lightdm-gtk-greeter:1585): Gtk-CRITICAL **: gtk_container_foreach: assertion 'GTK_IS_CONTAINER (container)' failed

    ** (lightdm-gtk-greeter:1585): WARNING **: Failed to load user image: Failed to open file '/home/xiajian/.face': No such file or directory


 网上别人遇到的Lightdm不能登录的问题的链接: 
 ubuntu lightdm登陆器不能用户登陆解决
  
 上周末编译了下kernel，刚刚make完，重起后却发现不能登陆了~~~
  
 网络上查找各种原因，最近却发现居然是登陆用户目录下没有可用的硬盘空间了。
  
 错误现象：
 在ubuntu的lightdm的登陆器上输入密码后，屏幕闪过某些信息，然后又重新回复到刚才的输入密码界面。
  
 修改/etc/lightdm/lightdm.conf
 其中添加greeter-show-manual-login=true后可以在lightdm中输入用户名
  
 [SeatDefaults]
 user-session=ubuntu
 greeter-session=unity-greeter
 greeter-show-manual-login=true
 allow-guest=false
 然后使用root尝试登陆，结果root用户可以正常登陆。
  
 按照网络上找到的修改方式，使用gdm登陆器登陆，查看是否成功。
 1. ctrl+alt+f1来启动命令行登陆
 2. 使用如下命令安装gdm。“sudo apt-get install gdm"
 3. 配置默认的登陆器选项。”sudo dpkg-reconfig gdm“ 使用gdm作为默认的登陆器
 4. 重启后，登陆
  
 结果发现使用gdm是可以正常的登陆的。
 但是在这个时候，启动某应用程序时候，发现error信息，提示说没有硬盘空间，这个可真是关键信息。哈哈，就这样，完成了
  
 而我用户目录下的硬盘空间却是在虚拟机中编译另外一个kernel时候，被完全占用了
  
 如下附上在查找过程中，有相类似的ubuntu登陆错误的解决方式：
  
 方案一：
 如果是lightdm的登陆器问题，而且是不知名的问题，可以直接使用gdm登陆器来登陆。但是登陆后会需要修改相关的bash，可能和之前lightdm登陆后的PATH变量的目录不同哦
  
 方案二：
 在登陆界面使用ctrl+alt+F1等进入命令行模式后，查看home目录下的 .Xauthority文件的属性，ower和group是否是你的用户名。否则修改后重启
 sudo chown yourusername:yourusername .Xauthority
  
 方案三：
 如果你在使用ubuntu时候有修改过桌面壁纸，可以使用方案一中的方式，首先登陆到gnome环境，然后修改壁纸为系统自带的壁纸，最后重启后使用lightdm来登陆
  
 方案四：
 如果非以上已知错误，而且也不是本人类似的没有硬盘空间的错误，在命令行下查看lightdm的错误信息，然后重新网上google。
 lightdm的log位置：
  
 sudo less /var/log/lightdm/x-0-greeter.log
 sudo less /var/log/lightdm/lightdm.log

地址: http://www.2cto.com/os/201305/213215.html

 偶然看到的有用的帖子: 
 1. http://forum.ubuntu.org.cn/viewtopic.php?t=350555
 2. http://forum.ubuntu.org.cn/viewtopic.php?t=463303


 coffeescript的地址: http://coffeescript.org/

 https://github.com/rails/coffee-rails
